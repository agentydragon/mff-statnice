\def\b#1{\mathbf{#1}}
\def\Ker{\mathrm{Ker\ }}
\def\Real{\mathbb{R}}
\def\rank{\mathrm{rank}}
\def\dim{\mathrm{dim}}
\def\Span{\mathcal{L}}


\section{Øešení soustav lineárních rovnic}

\begin{e}{Požadavky}{0}{0}
\begin{pitemize}
    \item Lineární množiny ve vektorovém prostoru, jejich geometrická interpretace
    \item Øešení soustavy rovnic je lineární množina
    \item Frobeniova vìta 
    \item Øešení soustavy úpravou matice 
    \item Souvislost soustavy øešení s ortogonálním doplòkem
\end{pitemize}
\end{e}

Pojem \uv{lineární množina} moc používaný není, proto se držím výrazu \uv{afinní podprostor}. Vypracováno s použitím poznámek a syllabu z lineární algebry Prof. Matouška a textu Doc. M. Èadka z MU Brno k lineární algebøe \\(\texttt{ftp://ftp.math.muni.cz/pub/math/people/Cadek/lectures/linearni\_algebra/LA2.pdf})\\

\subsection{Lineární množiny ve vektorovém prostoru}

\begin{e}{Definice}{0}{lineární množina / afinní podprostor}
Podmnožina vektorového prostoru $V$, která je buï prázdná, nebo tvaru
$$\b{x}+U=\{\b{x}+\b{u}|\b{u}\in U\}$$
kde $\b{x}\in V$ a $U\subset V$ je nìjaký podprostor $V$, se nazývá \emph{afinní podprostor}, \emph{lineární množina} nebo \emph{lineál}.
\end{e}

\begin{e}{Poznámka}{0}{Nejednoznaènost urèení afinního podprostoru}
Jeden afinní podprostor je možné urèit více zpùsoby, napø. pro vektorový prostor $V$ s vektorem $\b{v}$ a jeho podprostorem $U$ dávají $\b{v}+U$ a $2\b{v}+U$ stejný afinní podprostor.
\end{e}

\begin{e}{Vìta}{0}{Afinní podprostor urèuje vekt. prostor}
Mìjme nìjaký afinní podprostor $F$ ve vektorovém prostoru $V$. Je-li dáno:
\begin{align*}
    F &= U + \b{x} \\
    F &= U' + \b{x'}
\end{align*}
pak jistì $U=U'$.

\begin{e}{Dùkaz}{0}{0}
Oznaèíme $\tilde{U}=\{\b{y}-\b{z}|y,z\in F\}$ a dokážeme, že $\tilde{U}=U$ i $\tilde{U}=U'$.
\end{e} 
\end{e}

\begin{e}{Vìta}{0}{Lin. zobrazení urèuje afinní podprostor}
Budiž dáno lineární zobrazení $f:U\to V$ mezi nìjakými dvìma vekt. prostory. Pro libovolné $b\in f[U]$ potom platí:
$$f^{-1}(\b{b})=\{\b{u}\in U|f(\b{u})=\b{b}\}=\{\b{x}_0 + \Ker f\}$$
kde $x_0$ je libovolný vektor z množiny $f^{-1}(\b{b})$ a $\Ker f$ je jádro zobrazení $f$ (tj. $\Ker f=f^{-1}(\b{0})$).

\begin{e}{Dùkaz}{0}{0}
Plyne z faktu, že $\Ker f$ je vektorový podprostor $U$ a z linearity $f$.
\end{e}
\end{e}

\subsection{Geometrická interpretace}

\begin{e}{Definice}{0}{dimenze afinního podprostoru, nadroviny}
\emph{Dimenzi} afinního podprostoru $\b{x}+U$, kde $U\subseteq V$ je vektorový podprostor nìjakého vekt. prostoru $V$, definujeme jako $\dim(U)$. 

Jednodimensionání afinní podprostor se nazývá \emph{pøímka}, dvoudimensionální \emph{rovina}, $n-1$-dimensionální afinní podprostor $n$-dimensionálního prostoru se jmenuje \emph{nadrovina}.
\end{e}

\begin{e}{Poznámka}{0}{0}
Totéž platí pro afinní podprostory v $n-$rozmìrném eukleidovském geometrickém prostoru -- takže napø. roviny nebo pøímky v trojrozmìrném eukleidovském prostoru jsou afinní podprostory.
\end{e}

\begin{e}{Definice}{0}{Afinní kombinace bodù}
$\b{a},\b{b}$ buïte dva body (vektory) ve vektorovém prostoru $V$ nad tìlesem $T$. Potom pro $\alpha,\beta\in T$ lineární kombinace
$$\alpha\b{a}+\beta\b{b},\ \alpha+\beta=1_T$$
urèující nadrovinu se nazývá \emph{afinní kombinace bodù}. Afinní kombinace nìkolika bodù $\b{a}_1,\dots,\b{a}_k$ jsou pro $\alpha_i\in T$ body 
$$\sum_{i=1}^k\alpha_i\b{a}_i,\ \sum_{i=1}^k\alpha_i=1_T$$
\end{e}

\begin{e}{Vìta}{0}{Geometrické vyjádøení afinního podprostoru}
V afinním podprostoru $F$ nìjakého vekt. prostoru $V$ leží s každými $k$ body $\b{f}_1 \ldots \b{f}_k \in F$ i jejich afinní kombinace. Naopak každá množina $F$ ve vekt. prostoru $V$, v níž pro každé dva body leží i jejich afinní kombinace, je afinní podprostor.

\begin{e}{Dùkaz}{0}{0}
$F=\{U+\b{x}\}$ pro nìjaký podprostor $U\subset V$. Potom $$\forall i\in\{1,\dots,k\}:\b{f}_i=\b{x}+\b{u}_i$$ pro nìjaké $\b{u}_i\in U$. Platí:
$$\sum_{i=1}^k(\b{x}+\b{u}_i)\alpha_i = \sum_{i=1}^k\alpha_i\b{x} + \sum_{i=1}^k\alpha_i\b{u}_i = 1\cdot\b{x} + \sum_{i=1}^k\alpha_i\b{u}_i\in F$$

Opaènì zvolme $\b{u}\in F$, potom $F=\b{u}+\{\b{v}-\b{u},\b{v}\in F\}$ a staèí dokazát, že $U=\{\b{v}-\b{u},\b{v}\in F\}$ je podprostor $V$ (uzavøenost na skalární násobky a souèty).
\end{e}
\end{e}


\subsection{Øešení soustavy rovnic je lineární množina}

\begin{e}{Definice}{0}{Maticový zápis soustavy rovnic}
Uvažujme soustavu $m$ lineárních rovnic o $n$ neznámých ve tvaru:
$$\begin{matrix}
a_{1,1}x_1 &+ a_{1,2}x_2 &+ \dots &+ a_{1,n}x_n &=& b_1 \\
a_{2,1}x_1 &+ a_{2,2}x_2 &+ \dots &+ a_{2,n}x_n &=& b_2 \\
    \vdots &             &        &  \vdots     & & \vdots \\
a_{m,1}x_1 &+ a_{m,2}x_2 &+ \dots &+ a_{m,n}x_n &=& b_m \\
\end{matrix}$$
Takovou soustavu lze zapsat jako 
$$A\b{x}=\b{b}$$
kde 
\begin{pitemize}
    \item $A$ je \emph{matice soustavy} typu $m\times n$ (s $m$ øádky a $n$ sloupci), kde na souøadnicích $[i,j]$ je koeficient $a_{i,j}$,
    \item $\b{b}$ je sloupcový vektor pravých stran (matice typu $m\times 1$) a
    \item $\b{x}$ je sloupcový vektor neznámých (matice typu $n\times 1$)
\end{pitemize}
Maticový souèin $A\b{x}=\b{b}$ zøejmì dává stejný výsledek jako explicitní zápis soustavy.
\end{e}



\begin{e}{Vìta}{0}{Øešení soustavy rovnic je afinní podprostor}
Pro soustavu lineárních rovnic $A\b{x}=\b{b}$, kde $A$ je matice typu $m\times n$, $\b{b}$ je vektor \uv{pravých stran} a $\b{x}$ vektor neznámých, platí, že množina jejích øešení je
\begin{penumerate}
    \renewcommand{\labelenumi}{\alph{enumi})} 
    \item prázdná
    \item tvaru $\{\b{x}_0+L\}$, kde $\b{x}_0$ je jedno z øešení soustavy $A\b{x}=\b{b}$ a $L$ je množina všech øešení \emph{homogenní} soustavy $A\b{x}=0$.
\end{penumerate}

\begin{e}{Dùkaz}{0}{0}
Je-li $F$ množina øešení rovnic $A\b{x}=\b{b}$ neprázdná, potom platí:
\begin{penumerate}
    \item øádky matice $A$ generují nìjaký podprostor $L$, $\forall\b{u}\in L:A\b{u}=0$.
    \item jestliže pro nìjaké $\b{l}$ platí $A\b{l}=0$ (tedy $\b{l}\in L$) a mám nìjaké $\b{x}_0$, pro které platí $A\b{x}_0=\b{b}$, potom z distributivity násobení matic plyne $A(\b{x}_0+\b{l})=\b{b}$.
\end{penumerate}
\end{e}
\end{e}

\begin{e}{Vìta}{0}{Afinní podprostor lze popsat soustavou rovnic}
Opaèné tvrzení platí také -- každý afinní podprostor lze popsat soustavou lineárních rovnic.

\begin{e}{Dùkaz}{0}{0}
Ve vekt. prostoru $V$ mìjme afinní podprostor $F=\{U+\b{v}\}$, kde $U\subseteq V$ je podprostor $V$ a $\b{x}\in V$. $\b{u}_1,\dots,\b{u}_k$ buï báze $U$. Potom každé $\b{x}\in F$ vyhovuje soustavì rovnic
$$\left(\begin{matrix}\b{u}_1\\\vdots\\\b{u}_k\end{matrix}\right)\b{x}=\b{v}$$
\end{e}
\end{e}

\begin{e}{Dùsledek}{0}{0}
Je-li dána soustava rovnic $A\b{x}=\b{b}$, kde matice $A$ má $n$ øádkù, potom jí urèený afinní podprostor má dimenzi $n - \rank(A)$.
\end{e}


\begin{e}{Vìta}{0}{(neprázdný) prùnik afinních podprostorù je afinní podprostor}
Mìjme dány afinní podprostory $F_1=\{U_1+\b{x}_1\}$ a $F_2=\{U_2+\b{x}_2\}$ pro nìjaké podprostory $U_1,U_2$ vektorového prostoru $V$. Pokud $F_1\cap F_2\neq \emptyset$, potom $F_1\cap F_2$ je afinní podprostor $V$.

\begin{e}{Dùkaz}{0}{0}
Plyne z pøedchozích vìt o vztahu afinních podprostorù a soustav rovnic -- vezmeme rovnicové popisy $F_1$ a $F_2$ a složíme je pod sebe, tím dostaneme rovnicový popis dalšího afinního podprostoru (pokud daná soustava rovnic má øešení, tedy prùnik je neprázdný).
\end{e}

\begin{e}{Pøíklad}{0}{0}
Napø. prùnik pøímky a roviny v $\Real^3$ -- jeden bod -- je afinní podprostor :-).
\end{e}
\end{e}


\subsection{Frobeniova vìta }
 

\begin{e}{Vìta}{0}{Frobeniova}
Soustava lineárních rovnic $A\b{x}=\b{b}$ (kde $A$ je matice s $n$ sloupci) má alespoò jedno øešení, právì když platí
$$\rank(A)=\rank((A\ \b{b}))$$
kde $(A\ \b{b})$ pøedstavuje tzv. \emph{rozšíøenou matici soustavy}, tj. matici $A$ s \uv{pøilepeným} vektorem pravých stran $\b{b}$ v posledním sloupci.
\par\medskip
\begin{e}{Dùkaz}{0}{0}
$n$-tice skalárù $\alpha_1,\dots,\alpha_n$ je øešením soustavy $A\b{x}=\b{b}$, jinak zapsáno $A_1\alpha_1+\dots+A_n\alpha_n=\b{b}$, právì když sloupec $\b{b}$ je lineární kombinací sloupcù $A_i, i\in\{1,\dots,n\}$, tedy $\b{b}\in\Span(A_1,\dots,A_n)$. To znamená, že $\Span(A_1,\dots,A_n,\b{b})=\Span(A_1,\dots,A_n)$ a tedy
$$\rank(A)=\dim(\Span(A_1,\dots,A_n))=\dim(\Span(A_1,\dots,A_n,\b{b}))=\rank((A\ \b{b}))$$
\end{e}
\end{e} 

\subsection{Øešení soustavy úpravou matice }

\begin{e}{Definice}{0}{Elementární operace}
Následující tøi operace nazýváme \emph{elementárními operacemi} s maticí A (všechny jsou ekvivalentní vynásobení vhodnou regulární maticí zleva):
\begin{penumerate}
    \item vynásobení i-tého øádku èíslem $\alpha \neq 0$ \\ 
	(zapsáno formou maticového násobení $A' = (I+(\alpha -1)e_i e_i^T)A$)
    \item vynásobení i-tého øádku èíslem $\alpha$ a pøiètení k j-tému øádku, $j \neq i$  \\
	(maticový zápis $A' = (I+\alpha e_j e_i^T)A$)
    \item výmìna i-tého a j-tého øádku, $i \neq j$ (je možné \uv{složit} z pøedcházejících dvou) \\
	(maticový zápis $A' = (I+(e_i - e_j)(e_j-e_i)^T) A$)
\end{penumerate}
\end{e}

\begin{e}{Vìta}{0}{O elementárních operacích}
Elementární operace na rozšíøené matici $(A\ \b{b})$ soustavy rovnic $A\b{x}=\b{b}$ nemìní množinu øešení soustavy.
\par\medskip
\begin{e}{Dùkaz}{0}{0}
Dùkaz staèí pro operace 1. a 2., protože tøetí je jejich kombinací. Pro úpravy:
\begin{penumerate}
    \item Po úpravì jsou všechny rovnice (øádky matice) až na $i$-tou nezmìnìné, tedy každé $\b{x}$ øešení pùvodní soustavy je splòuje. Pro upravený øádek platí $$\alpha(a_{i,1}x_1+\dots+a_{i,n}x_n)=\alpha\cdot b_i$$ což je zøejmì také splnìno. Podobnì se dokáže, že každé $\b{x}$ øešení upravené matice splòuje i všechny rovnice pùvodní.
    \item Všechny øádky až na $j$-tý jsou nezmìnìné a pro $j$-tý øádek platí: 
$$\alpha(a_{i,1}x_1+\dots+a_{i,n}x_n)+(a_{j,1}x_1+\dots+a_{j,n}x_n)=\alpha b_i + b_j$$
a to je také splnìno. Opaèná implikace se dokáže podobnì.
\end{penumerate}
\end{e}
\end{e}

\begin{e}{Definice}{0}{Odstupòovaný tvar matice}
Øekneme, že matice $A$ typu $m\times n$ je v (øádkovì) \emph{odstupòovaném tvaru}, jestliže jsou splnìny následující podmínky:
\begin{penumerate}
    \item existuje $r: 0\leq r \leq m$ takové, že øádky $1,\dots,r$ jsou nenulové a $r+1,\dots,m$ nulové
    \item pro $j(i)=\min\{j | a_{i,j}\neq 0\}$ platí $j(1)\leq j(2)\leq \dots\leq j(r)$
\end{penumerate}
\end{e}

\begin{e}{Algoritmus}{0}{Øešení soustavy lin. rovnic}
Soustavu lineárních rovnic $A\b{x}=\b{b}$ lze øešit následovnì
\begin{penumerate}
    \item Sestavit rozšíøenou matici soustavy
    \item Pøevést pomocí elementárních úprav matici do odstupòovaného tvaru
    \item Pomocí zpìtné substituce popsat všechna øešení
\end{penumerate}
\end{e}

\begin{e}{Algoritmus}{0}{Gaussova eliminace}
\emph{Gaussova eliminace} je algoritmus pro úpravu dané matice $A$ na odstupòovaný tvar elementárními øádkovými úpravami. Postup:
\begin{penumerate}
    \item Utøídíme øádky podle délek úsekù poèáteèních nul vzestupnì
    \item Najdeme-li dva øádky se stejnì dlouhým úsekem poè. nul ($j(i)=j(i+1)$), potom k $i+1$-tému øádku pøièteme $-\frac{a_{i+1,j(i)}}{a_{i,j(i)}}$-násobek i-tého øádku
    \item Kroky 1. -- 2. opakujeme, dokud existují dva øádky se stejnì dlouhým úsekem poè. nul.
\end{penumerate}

\noindent
Je zaruèeno, že algoritmus skonèí, protože s každým cyklem roste souèet délek poèáteèních úsekù nul všech øádkù minimálnì o 1 a ten je omezený èíslem $m\times n$. Složitost algoritmu je $O(m\cdot n^2)$.
\end{e}

\begin{e}{Algoritmus}{0}{Zpìtná substituce}
Buï $E$ rozšíøená matice soustavy $A\b{x}=\b{b}$ v odstupòovaném tvaru (získaná pomocí elementárních úprav). Pokud poèáteèní úsek nul na nìjakém øádku má délku $n$ (tedy nenulové èíslo je jen ve sloupci pravých stran), soustava nemá øešení. Jinak nazveme \emph{bázové promìnné} ty, v jejichž sloupci je v nìjakém øádku první nenulové èíslo ($x_{j(1)},\dots,x_{j(m)}$), ostatní nazveme \emph{volné}. Existuje potom jednoznaèné pøiøazení hodnot bázovým promìnným tak, že dohromady tvoøí øešení soustavy. Každé øešení je navíc možné získat touto metodou.

\medskip \noindent \emph{Postup:}

\noindent Indukcí podle $i=r,r-1,\dots,2,1$. Nech $x_{j(i)}$ je i-tá bázová promìnná a hodnoty promìnných $x_k$ pro $k>j(i)$ jsou dané (buï jsou volné, nebo využívám ind. pøedpoklad). Potom po dosazení do $i$-té rovnice získám 
$$0x_1+\dots+0x_{j(i)-1}+a_{i,j(i)}x_{j(i)}+\dots+a_{i,j(n)}x_n=b_i$$
tedy jednu rovnici o 1 neznámé, která má jednoznaèné øešení. Libovolné øešení této soustavy $x_1,\dots,x_n$ lze získat touto metodou -- staèí nastavit volné promìnné podle nìj a bázové vyjdou správnì, protože jejich hodnota je urèena jednoznaènì. Navíc které promìnné jsou volné a které jsou bázové je také urèeno jednoznaènì -- jinak vždy najdu rùzné množiny øešení (což je pro stejnou soustavu rovnic nesmysl).
\end{e}

\begin{e}{Algoritmus}{0}{Gauss-Jordanova eliminace}
Gauss-Jordanova eliminace je varianta Gaussovy eliminace, která pøevádí matici na tzv. \emph{redukovaný odstupòovaný tvar}, to je takový tvar, kde v každém sloupci, pøíslušejícím nìjaké bázové promìnné, je pouze jedno nenulové èíslo. Zpìtná substituce je pak jednodušší, ale je tøeba více aritmetických operací (asymptoticky jsou však algoritmy stejné)

TODO: zkontrolovat \& doplnit podrobnìji
\end{e}

\begin{e}{Poznámka}{0}{0}
S øešením soustav rovnic Gaussovou metodou nastává problem pøi strojových výpoètech -- i malá zaokrouhlovací chyba mùže zpùsobit velmi radikální zmìnu množiny øešení (takové matice soustav se nazývají \emph{špatnì podmínìné}).
\end{e}

\subsection{Souvislost soustavy øešení s ortogonálním doplòkem}

\begin{e}{Definice}{0}{Ortogonální doplnìk}
Ve vektorovém prostoru $V$ se skaláním souèinem definujeme \emph{ortogonální doplnìk} množiny $M\subseteq V$ jako $$M^{\bot}=\{\b{v}\in V:\left<\b{v},\b{x}\right>=0\ \forall\b{x}\in M\}$$
\end{e}

\begin{e}{Vìta}{0}{Množina øešení homogenní soustavy je ortog. doplnìk øádkù její matice}
Mìjme dánu homogenní soustavu lineárních rovnic $A\b{x}=\b{0}$ potom její množina øešení je ortogonální doplnìk množiny jejích øádkù 
$$\{\b{x}|A\b{x}=\b{0}\}=\{A_1,A_2,\dots,A_n\}^{\bot}$$
pøièemž uvažujeme standardní skalární souèin $\left<\b{x},\b{y}\right>=x_1y_1+\dots+x_ny_n$.
\end{e}

TODO: tady je toho dost málo (aè je to všechno co jsme kdy probírali), jestì nìco sem doplnit ???

\begin{e}{Report}{0}{Kuèera} Øešení soustavy lineárních rovnic - K tìm rovnicím jsem napsal necelou A4 a to spíš jen takovou okecávaèku (Gaussova eliminace, pøevod soustavy na matici apod.). K tomu jsem teda dostal pár doplòujících dotazù, ale nic záludnýho (co je množina øešení, kdy má nehomogenní soustava øešení, proè elementární úpravy nemìní množinu øešení, pak ještì myslim vzoreèek z Cramerova pravidla). Výsledek: 1 (úplnì bez dùkazù)
\end{e}
\begin{e}{Report}{0}{Kolman} reseni soustavy linearnich rovnic - zprasila jsem Gaussovu eliminaci (s komentarem: tohle je princip a jeste se to musi trochu, teda vlastne hodne, opodminkovat...) 
{Loebl} reseni soustav linearnich rovnic - Napsal jsem na tema dve stranky, kdyz ke mne prisel, tak nechtel nic rikat, jen si to zbezne prohlednul a chtel dopsat jeden vzorecek, dukaz zadny. Za pet minut mi psal jednicku do "formulare". 
\end{e}
\begin{e}{Report}{0}{Kuèera} co sem videl vedle kde kdosi nebyl schopen dat dohromady frobeniovu vetu tak bych dokonce rekl ze je velice trpelivy
\end{e}
\begin{e}{Report}{0}{Fiala} Frobeniova veta + ako spolu suvisi mnozina rieseni homogennych a nehomogennych matic 
\end{e}
\begin{e}{Report}{0}{Žemlièka} øešení soustavy lin.rovnic pomocí matic. Soustava pomocí matic bylo víceménì povídání o Gaussovì eliminaci, kdy je jaký prostor øešení, co s nulovými øádky atd. Uvedl jsem afinní prostor (vektor x0+ortogonální doplnìk A), také že úpravou Ax=b dostanu x=A-1 .b (inv.matice krát vektor pravých stran) a dostalo se mi otázky, k èemu je to dobré. Oèekávaná odpovìï: pokud je vícero pravých stran, tak staèí Gaussovu eliminaci provést jen jednou (ale až do diagonální matice). Taky se p. Žemlièka ptal na implementaci Gaussovy eliminace - co hrozí a jak se toho vyvarovat (numericky nestabilní algoritmus, hrozí chyby ze zaokrouhlování, které se propagují). Použít pøesnìjší reprezentaci R, spec. reprezentaci Q nebo úplnì jiný algoritmus...
\end{e}
\begin{e}{Report}{0}{Fiala} Souvislost reseni soustav linearnich rovnic s ortogonalnim doplnkem. Nu coz, zacal jsem z definicemi vseho co s tim souvisi:
soustava linearnich rovnic, matice, radkovy a sloupcovy prostor, skalarni soucin, ortogonalni mnozina
Moje tuseni ze ortogonalni doplnek radkoveho prostoru souvisi s mnozinou reseni bylo spravne.
\end{e}
\newpage