\subsection{Kryptografické algoritmy a protokoly}

\begin{obecne}{Cíle kryptografie}
  \begin{pitemize}
    \item dùvìrnost dat
    \item celistvost dat
    \item autentifikace~-- od koho jsou data
    \item nepopiratelnost~-- kdy jednou nìco potvrdím, nemohu to popøít.
  \end{pitemize}
\end{obecne}

\begin{e}{Definice}{0}{Kryptografickı systém}
 \textbf{ Kryptografickı systém} obsahuje:
  \begin{pitemize}
    \item prostor zpráv~-- \emph{plaintext},
    \item prostor šifrovanıch zpráv~-- \emph{ciphertext},
    \item prostory šifrovacích a dešifrovacích \emph{klíèù},
    \item efektivní algoritmus pro \emph{generování klíèù},
    \item efektivní algoritmus pro \emph{šifrování},
    \item efektivní algoritmus pro \emph{dešifrování}.
  \end{pitemize}
\end{e}

\begin{e}{Definice}{0}{oznaèení}
  $C$~-- šifra, $P$~-- otevøenı text, $K$~-- klíè,\\
  $\mathbf{E}$~-- šifrovací algoritmus, $\mathbf{D}$~-- dešifrovací algoritmus.\\[3mm]
  \emph{Šifrování:} $C = \mathbf{E}(P)$, resp. $C = \mathbf{E}(K, P)$\\
  \emph{Dešifrování:} $P = \mathbf{D}(C)$, resp. $P = \mathbf{D}(K, C)$\\
\end{e}


\begin{obecne}{Kerchoffovy principy dobrého krypt. systému}
\begin{pitemize}
    \item E a D neobs. tajnou èást
    \item E distribuuje rozumné zprávy rovnomìrnì po C
    \item se správnım klíèem jsou E \& D efektivní
    \item bez správného klíèe je dešifrování minimánì NP-úplné. 
\end{pitemize}
\end{obecne}

\begin{obecne}{dìlení kryptografickıch systémù}
\begin{pitemize}
    \item symetrické krypt. systémy : $k = k'$
    \item asymetrické : $k \neq k'$ ( veøejnı a tajnı klíè ). 
\end{pitemize}
\end{obecne}

\begin{obecne}{Model útoèníka podle Doleva a Yao}
\begin{pitemize}
    \item mùe získat jakokoliv zprávu jdoucí po síti, mùe zahájit komunikaci s jinım uivatelem, mùe se stát pøíjemcem zpráv od kohokoliv, mùe zasílat zprávy komukoliv \& vydávat se za jiného uivatele, 
    \item nemùe uhádnout náh. èíslo z dost velké mnoiny, bez klíèe nemùe dešifrovat zprávu \& nemùe vytvoøit platnou šifrovanou zprávu (vzhledem k šifr. alg.).
\end{pitemize}
\end{obecne}

\subsubsection*{Kryptografické protokoly}

\begin{pitemize}
   \item \textbf{Arbitrované protokoly}~-- rozhodèí dìlá skoro všechno.
   \item \textbf{Rozhodované protokoly}~-- rozhodèí je dobrı jenom pøi sporu aby rozhodl.
   \item \textbf{Samozabezpeèovací protokoly}~-- není ádná tøetí strana.
\end{pitemize}

\begin{obecne}{Anonymní platby}
  Problém kreditních karet spoèívá v sledovatelnosti toku penìz. Hledáme protokol
  pro tvorbu autentizovanıch ale nesledovatelnıch zpráv.
\end{obecne}

\begin{obecne}{Èasové známky}
  Nejjednodušší metodou je zasílat kopie zpráv dùvìryhodnému arbitrovi, problémy s
  mnostvím uchovávanıch dat lze vyøešit pouitím hašovacích funkcí.

  Pouívají se spojené (linked) aby odesílatel spolu s arbitrem nemohli podvádìt.
  \begin{penumerate}
    \item Odesílatel $S$ zašle arbitrovi $A$ hashkod zprávy $H_n$.
    \item $A$ vrátí odesílateli 
    $T_n=S_K(n,S,H_n,Tm_n;Id_{n-1},H_{n-1},T_{n-1},H(Id_{n-1},H_{n-1},T_{n-1}))$
    kde $n$ je poøadí zprávy, $Tm_n$ èas podpisu zprávy, $Id_{n-1}\ldots$ jsou informace
    o pøedešlé zprávì, kterou arbitr vyøizoval.
    \item Po vyøízení následující zprávy arbitr zašle odesílateli identifikaci
    následujícího odesilatele
  \end{penumerate}
  Chce-li nìkdo ovìøit èasovou známku zprávy, kontaktuje odesilatele $Id_{n-1}$ a
  $Id_{n+1}$ a pomoci nich ovìøí platnost $T_n$
\end{obecne}

\begin{obecne}{Digitální podpisy}
  Musí bıt nefalšovatelné, autentické, nemìnitelné, \uv{nerecyklovatelné}.
  \paragraph{Symetrické systémy:}
   Nech odesílatel $S$ zasílá pøíjemci $R$ zprávu $M$
   \begin{penumerate}
      \item $S$ zašle arbitrovi $A$ zprávu $\mathbf{E}(M,K_S)$.
      \item Arbitr verifikuje odesílatele a pøíjemci $R$ zašle 
      $\mathbf{E}((M,S, \mathbf{E}(M,K_S)),K_R)$
      \item Pøíjemce uchová $M$ a $\mathbf{E}(M,K_S)$ pro úèely pøípadného dokazování pøijetí.
   \end{penumerate}

   \paragraph{Asymetrické systémy:}
   Staèí provést $\mathbf{E}(\mathbf{D}(M,K_S),K_R)$

\end{obecne}

\begin{obecne}{Dùkazy s nulovou znalostí}
  \begin{pitemize}
    \item dokazovatel nesmí podvádìt - pokud dùkaz nezná, jeho šance pøesvedèit arbitra
    je mizivá
    \item ovìøovatel nesmí podvádìt - o dùkazu smí zjistit jenom to, ze ho dokazovatel zná.
    V ádném pøípadì nesmí bıt schopen dùkaz zrekonstruovat a sám provést.
    \item ovìøovatel se nesmí dozvìdìt nic, co by nebyl schopen zjistit bez pomoci 
    dokazovatele.
  \end{pitemize}
  Není-li splnìna poslední podmínka mluvíme o \emph{dùkazech s minimálním vyzrazením}.
  Jeden z monıch dùkazù je zaloen na problematice Hamiltonovskıch krunic v grafu.
  \begin{penumerate}
    \item Nech $A$ zná Hamiltonovskou krunici v grafu $G$.
    \item $A$ provede náhodnou permutaci oèíslování vrcholù $G$. Pùvodní graf a vzniklı $H$ jsou izomorfní.
    \item Kopie grafu $H$ je zaslána entitì $B$.
    \item Ovìøovatel $B$ poloí dokazovateli $A$ jednu z následujících otázek
    \begin{penumerate}
	\item Dokázat, e $G$ a $H$ jsou izomorfní
	\item Ukázat Hamiltonovskou krunici v grafu $H$
    \end{penumerate}
    \item Opakováním kroku 1. a 4. lze docílit potøebné jistoty. 
  \end{penumerate}
\end{obecne}

\begin{obecne}{Neurèitı obnos (Oblivious transfer)}
  Protokol umoòuje, aby si adresát vybral z nìkolika nabízenıch moností ani
  by odesílatel pøedem znal jeho volbu, moné doplnìní o následnou vzájemnou
  kontrolu.
\end{obecne}

\begin{obecne}{Podepisování kontraktù (Contract signing)}
  V kadém okamiku musí bıt obì smluvní strany vázány stejnì moc.
  Nejjednodušším øešením je arbitrovanı protokol, kde obì strany pøedají
  centrální autoritì své podepsané kopie a tato tøetí strana zajistí vımìnu po
  obdrení obou kopií.
\end{obecne}

\begin{obecne}{Elektronická potvrzovaná pošta (digital certified mail)}
  Chceme, aby adresát mohl pøeèíst naši zprávu a poté, co získáme potvrzení o
  tom, e ji obdrel (elektronickı doporuèenı dopis).
\end{obecne}

\begin{obecne}{Bezpeèné volby}
  \begin{pitemize}
    \item volit smí pouze oprávnìní volièi,
    \item kadı smí hlasovat nejvıše jednou,
    \item nikdo nesmí vìdìt, kdo jak volil,
    \item nikdo nesmí mìnit volbu jinıch,
    \item kadı hlas musí bıt zapoèítán.
  \end{pitemize}

  Nejjednodušší monost je pouít protokol se dvìmi centrálními autoritami.
  Pouívá registraèní autoritu $RA$ provádìjící registraci volièù a sèítací
  autoritu $SA$, která sèítá hlasovací lístky a zveøejòuje vısledky voleb.
  \begin{penumerate}
    \item Všichni volièi zašlou $RA$ ádost o validaèní èíslo.
    \item $RA$ zašle kadému volièi náhodnì zvolené validaèní èíslo $L$ a zároveò
    si poznamená kdo jaké èíslo dostal.
    \item $RA$ zašle seznam validaèních èísel $SA$.
    \item Kazdy z volièù si náhodnì vybere svoje identifikaèní èíslo $Id$ a $SA$
    zašle zprávu $(L, Id, v)$ kde v je jeho volba.
    \item $SA$ porovná $L$ se seznamem validaèních èísel z kroku 3. Odpovídající
    èíslo škrtne a volièovo $Id$ pøidá do seznamu asociovaného s volenım kandidátem.
    \item Po skonèení voleb $SA$ zveøejní vısledky a seznamy identifikaèních èísel
    spojené se jmény kandidátù.
  \end{penumerate}
\end{obecne}

\begin{obecne}{Útoky na protokoly}
  \begin{pitemize}
    \item \emph{pøehrání zpráv}~-- M odposlouchá všechny zprávy a pak toté udìlá sám
    \item \emph{mu uprostøed} (man-in-the-middle)
    \item \emph{paralelní spojení}~-- nìkolik bìhù protokolù provádìnıch souèasnì pod
    øízením M
    \item \emph{odraení}~-- A zahájí komunikaci, M zachytí zprávu, upraví ji, aby
    nebyl poznat pùvodní A a pošle ji zpìt A
    \item \emph{prokládání}~-- Nìkolik bìhù protokolu provádìnıch souèasnì pod
    øízením M, zprávy z jednoho se pouijí u dalšího, atd.
    \item \emph{chyba typu}~-- Nedodrení pøesného sémantického vıznamu zprávy
    \item \emph{vypuštìní jména}~-- Pokud v protokolu není poznat, kdo za to mùe
    \item \emph{chybné pouití šifrovací sluby}~-- Špatnı algoritmus pouitı na nevhodném místì
  \end{pitemize}
\end{obecne}

\subsubsection*{Kryptografické algoritmy}

\begin{e}{Definice}{0}{Substitution-box~-- S-box}
  \begin{pitemize}
    \item krabièka která z \emph{m} bitù vstupu dìlá \emph{n} bitù vıstupu.
    \item nìkdy je pouita pevná tabulka. Napø. u DES
    \item nìkdy je vıstup s-boxu závislı na klíèi. Napø. u Blowfish, Twofish
    \item v blokovıch šifrách je to èasto s-box kdo zamluje vztah mezi plaintextem a šifrou.
    \item dost èasto na nìm závisí jak je šifra napadnutelná $\Rightarrow$ musí
    se volit dost obezøetnì
  \end{pitemize}
\end{e}

\begin{obecne}{Symetrické}
  \begin{pitemize}
    \item vysoká datová propustnost
    \item klíèe na obou koncích musí zùstat utajeny $\Rightarrow$ je tøeba èasto
    mìnit klíèe
    \item potøeba ovìøené TTP (Trusted Third Party)
  \end{pitemize}
\end{obecne}

\begin{obecne}{DES}
  Vyvinula firma IBM na zakázku NBS poèátkem 70. let. Pùvodní název DEA, v USA
  DEA1. Jako standard pøijat 23. 11. 1976 Dodnes pouíván v komerèní sféøe, pro
  vojenské úèely není certifikován ani pro ochranu neklasifikovanıch informací.
  Patrnì nejrozsáhleji pouívanı šifrovací algoritmus všech dob.

  Šifruje 64-bitové bloky otevøeného textu na 64-bitové vıstupní bloky, délka
  klíèe 64 bitù.

  \begin{figure}[!ht]
    \begin{center}
      \includegraphics[scale=.7, angle=90]{informatika/algoritmy_a_ds/obrazky/DES-main-network.png}
      \caption{Struktura hlavní sítì algoritmu DES (zdroj: Wikipedie)}
    \end{center}
  \end{figure}

  \paragraph{Analıza:}
  \begin{pitemize}
    \item velká slabina je 64-bitovı klíè (navíc efektivnì pouze 56-bitovı).
    Prolomen za ménì ne 24 hodin.
    \item úvodní permutace nemá prakticky ádnı vliv
    \item existence slabıch $(\mathbf{E}(K)=\mathbf{D}(K))$ a poloslabıch
    $(\mathbf{E}(K_1)\mathbf{E}(K_2)=Id.)$ klíèù
    \item komplementárnost $C=\mathbf{E}(K,P)\Leftrightarrow\lnot C= \lnot
    \mathbf{E} (\lnot K,\lnot P)$
  \end{pitemize}
\end{obecne}

\begin{obecne}{Blowfish}
  \begin{pitemize}
    \item nástupce systému DES, 
    \item opìt Feistelova šifra, délka bloku je 64 bitù, promìnná délka klíèe a 448 bitù
    \item algoritmus provádí 16 cyklù nad vstupem délky 64-bitù
  \end{pitemize}
\end{obecne}

\begin{obecne}{IDEA}
  \begin{pitemize}
    \item z roku 1991, vyšel pod názvem IPES. 
    \item IDEA (International Data Encryption Algorithm)
    \item bloková šifra s délkou bloku 64-bitù a délkou klíèe 128-bitu
    \item algoritmus je patentován 
    \item zajímavé je e pokud bychom algoritmus upravili tak, e bychom všechny øetìzce
    se kterımi pracuje zvìtšili na dvojnásobek, tak dojde ke ztrátì bezpeènosti.
    \item algoritmus je povaován za bezpeènı.
  \end{pitemize}
\end{obecne}

\begin{obecne}{RC5}
  \begin{pitemize}
    \item z roku 1994 od R. Rivesta
    \item pouívá rotace závislé na datech.
    \item algoritmus umoòuje nastavit spoustu parametrù:
    \begin{pitemize}
      \item délka šifrovacího klíèe (0\dots255 bytù)
      \item poèet kol šifrovacího procesu (0\dots255)
      \item z hodnot 16, 32, 64, ale i vyšších lze zvolit délku slova, algoritmus
      zpracovává bloky o délce dvojnásobku slova
    \end{pitemize}
  \end{pitemize}

\end{obecne}

\begin{obecne}{Kryptosystém Rijndael}
  \begin{pitemize}
    \item produkèní bloková šifra
    \item promìnná délka bloku~-- 16, 24 nebo 32 bajtù
    \item promìnná délka klíèe~-- 128, 192 nebo 256 bitù
  \end{pitemize}

  \paragraph{Analıza:} Po rozsáhlé analıze nenalezena ádná slabina a tak
  zvolen jako novı standard AES.
\end{obecne}

\begin{obecne}{RC4}
  \begin{pitemize}
    \item proudová šifra od R. Rivesta
    \item jednoduchı a rychlı algoritmus 

    \paragraph{Analıza:} Zatím není známı ádnı zpùsob útoku $\Rightarrow$
    algoritmus povaován za bezpeènı.
  \end{pitemize}
\end{obecne}

\begin{obecne}{FISH}
  \begin{pitemize}
    \item proudová šifra zaloena na Fibonacciho generátoru pseudonáhodnıch èísel.
    \item z fibonacciho generátoru se získá posloupnost a šifrovaní se provádí
    napøíklad XORováním této posloupnosti s \emph{P}
  \end{pitemize}
\end{obecne}

\begin{obecne}{Asymetrické}
  \begin{pitemize}
    \item šifry s asymetrickım klíèem~-- RSA, DSA (ElGammal)
    \item mnohem pomalejší
    \item není potøeba TTP
    \item pouze jeden klíè tajnı, nemusí se mìnit tak èasto
    \item o ádném schématu veøejného klíèe nebylo dokázáno, e je bezpeèné
  \end{pitemize}
\end{obecne}

\begin{obecne}{RSA}
  Kryptoschéma je zaloeno na Eulerovì formuli: 
  $$a^{\varphi(n)} \equiv 1(mod\ n)$$ 
  kde $\varphi(n)$ je poèet èísel z intervalu $1..n$ která jsou s $n$ nesoudìlná.

  \paragraph{Šifrování:} Je tøeba znát èíslo $n$ a malé prvoèíslo $e$. Otevøenı
  text pøevedeme do posloupnosti modulo $n$. Kadı blok $P_j$ zašifrujeme dle
  vzorce: $$C_j\equiv P_j^e\ (mod\ n)$$ Spojením vıslednıch blokù vznikne
  zašifrovanı text.

  \paragraph{Dešifrování:} Je tøeba znát èíslo $n$ a èíslo $d$. Kadı z blokù
  potom dešifrujeme takto: $$P_j\equiv C_j^d\ (mod\ n)$$ Pro dešifrovací klíè
  $d$ musí platit: $$ed\equiv 1\,(mod\ \varphi(n))$$ Prvoèíslo $e$ nesmí dìlit
  $\varphi(n)$. $d$ urèíme z pøedchozího vztahu rozšíøenım eukleidovım
  algoritmem.

  Veøejnı klíè tvoøí pár $(n, e)$, soukromı klíè pár $(n, d)$. Èíslo $n$ musí bıt velmi
  velké a nesmí mít malé faktory. Pro reálné pouití 100 a 200 bitù. Hranice bezpeènosti
  1024 bitù modulu $n$, rozumné 1500 bitù, lépe 2048 bitù.

  Není známa ádná metoda vedoucí k rozbití algoritmu RSA. 
\end{obecne}

\begin{obecne}{Merkle-Hellman kryptosystém}
  \begin{pitemize}
    \item zaloen na problému batohu
    \item plaintext je chápán jako posloupnost vah (øešení)
    \item ciphertext je vısledná hmotnost batohu
    \item pro superrostoucí posloupnost je problém øešitelnı v lineárním èase
    \item superrostoucí posloupnost je souèást soukromého klíèe a tak
    dešifrování pomocí ní je zvládnutelné lineárnì, kdeto bez ní je to NP-úplnı
    problém
    \item systém byl prolomen! Není tedy povaován za bezpeènı. Útoèník je
    schopen získat superrostoucí posloupnost a pomocí ní mùe dešifrovat
  \end{pitemize}
\end{obecne}

\begin{obecne}{Elgamal kryptosystém}
  Zaloen na obtínosti vıpoètu diskrétního logaritmu nad kruhem.

  Potøebujeme spoleènı modul $q$ a èíslo $g$ co nejvyššího øádu. Kadı úèastník si zvolí tajnı
  klíè $y_i$ a vypoèítá veøejnı klíè $g^{y_i}$ mod $q$.
  \paragraph{Šifrování:} Nech uivatel \emph{A} posílá zprávu \emph{P}
  uivateli \emph{B}. Náhodnì
  vybere èíslo $k$ a vypoèítá: $$ g^k \mod q;\ P \otimes{(g^{y_b})}^k \mod q
  $$ obì èísla zašle \emph{B}.

  \paragraph{Dešifrování:} Uivatel \emph{B} vypoèítá: $$ {(g^k)}^{y_b} \mod q$$
  a najde inverzní prvek. Z druhého èísla potom snadno získá \emph{P}.

  Systém je povaován za bezpeènı. Nevıhodou je nutnost generovat náhodné èíslo
  $k$ a zdvojnásobení dat bìhem šifrování.
\end{obecne}
