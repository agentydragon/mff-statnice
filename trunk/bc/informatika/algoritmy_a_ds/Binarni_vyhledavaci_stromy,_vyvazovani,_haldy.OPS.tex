\def\b#1{\mathbf{#1}}


\subsection{Binární vyhledávací stromy, vyvaování, haldy}

pozn. -- jako skoro u všech algoritmù, doporuèuju si pustit Kuèerovo Algovision -- \url{http://www.algovision.org/Algovision/Algovision.html} -- vysvìtlivky k~nìmu jsou tady -- \url{http://kam.mff.cuni.cz/~ludek/AlgovisionTexts.html}.

\subsubsection*{Binární strom}

\begin{e}{Definice}{0}{0}
\emph{Dynamická mnoina} je mnoina prvkù (datová struktura), mìnící se v èase. Kadı její prvek je pøístupnı pøes ukazatel a obsahuje:
\begin{pitemize}
    \item \emph{klíè} (jednu poloku, typicky hodnotu z lin. uspoøádané mnoiny), 
    \item \emph{ukazatel(e)} na další prvky, 
    \item pøípadnì \emph{další data}.
\end{pitemize}
Na takové mnoinì jsou definovány tyto operace:
\begin{pitemize}
    \item \emph{find} - nalezení prvku podle klíèe
    \item \emph{insert} - pøidání dalšího prvku
    \item \emph{delete} - odstranìní prvku
    \item \emph{min}, \emph{max} - nalezení nejvìtšího / nejmenšího prvku
    \item \emph{succ}, \emph{pred} - nalezení následujícího / pøedcházejícího prvku k nìjakému pøedem danému
\end{pitemize}
\end{e}


\begin{e}{Definice}{0}{0}
\emph{Binární strom} je dynamická mnoina, kde kadı prvek (uzel, node) má kromì klíèe a pøíp. dalších dat (tøi) ukazatele na \emph{levého} a \emph{pravého} syna (a rodièe). Speciální uzel je \emph{koøen}, kterı má NULLovı ukazatel na rodièe. Ten je v binárním stromì jeden. Uzly, které mají NULLové ukazatele na pravého i levého syna, se nazıvají \emph{listy}.

\emph{Podstrom} je èást stromu (vybrané prvky), která je sama stromem - napø. pokud se jako koøen urèí jeden z prvkù. \emph{Levı(pravı)} podstrom nìjakého prvku je strom, ve kterém je koøenem levı(pravı) syn tohoto prvku. \emph{Vıška stromu} je délka nejdelší cesty od koøenu k listu.
\end{e}

Binární strom je \emph{dokonale vyváenı}, jestlie pro kadı jeho vrchol platí, e poèet prvkù v jeho levém a pravém podstromu se liší nejvıše o 1.
\\ 
Vıška dokonale vyváeného stromu roste logaritmicky vzhledem k poètu uzlù. Vıška nevyváeného stromu mùe rùst a lineárnì vzhledem k poètu prvkù (i \uv{spojovı seznam} je platnı bin. strom).


\subsubsection*{Binární vyhledávací strom}

\begin{e}{Definice}{0}{0}
\emph{Binární vyhledávací strom} je takovı binární strom, ve kterém je jeho struktura urèená podle klíèu jeho uzlù: pro kadı uzel s klíèem hodnoty $k$ platí, e jeho levı podstrom obsahuje jen uzly s menší hodnotou klíèe ne $k$ a jeho pravı podstrom jen uzly s hodnotou klíèe vìtší nebo rovnou $k$.
\end{e}

\begin{e}{Algoritmus}{0}{Vyhledávání v bin. stromì}
\begin{verbatim}
Find( x - koøen, k - hledaná hodnota klíèe ){
  while( x != NULL && k != x->klíè ){
    if ( k < x->klíè )
      x = x->levı_syn;
    else
      x = x->pravı_syn;
  }
  return x;
}
\end{verbatim}

Sloitost je $O(h)$ v nejhorším pøípadì, kde $h$ je vıška stromu (tj. pro nevyváené stromy a $O(n)$ kde $n$ je poèet prvkù). Asymptotická èasová sloitost ostatních operací je stejná.

Vloení a vymazání prvku se provádí prostım nalezením místa, kam by se prvek mìl vloit (nebo kde u je), a pøepojením pointerù.
\end{e}

\subsubsection*{Vyvaované vyhledávací stromy}

Kvùli zajištìní vìtší rychlosti (menší asymptotické èasové sloitosti) operací byly vytvoøeny speciální druhy binárních vyhledávacích stromù, které jsou prùbìnì vyvaovány, aby mìly max. vıšku menší ne $c\cdot\log n$, kde $n$ je poèet uzlù a $c$ nìjaká konstanta.

\begin{e}{Definice}{0}{Pomocné operace na stromech}
Pro vyvaování stromù pøi vkládání a odebírání uzlù se definují pomocné operace: \emph{pravá} a \emph{levá rotace}. Zachovávají vlastnosti bin. vyhledávacích stromù a jsou proveditelné v konstatním èase - jde jen o pøepojení uzlù násl. zpùsobem (pro pravou rotaci na uzlu $Q$ a levou na $P$):

\begin{center}
\includegraphics[width=12cm]{informatika/algoritmy_a_ds/obrazky/tree_rotation.png}

(Zdroj obrázku: Wikipedia)
\end{center}
\end{e}


\begin{e}{Definice}{0}{Èerveno-èerné stromy}
Èerveno-èerné stromy jsou binární vyhledávací stromy s garantovanou max. vıškou $O(\log n)$, kde $n$ je poèet uzlù, tj. operace na nich mohou mít asymptotickou èasovou sloitost $O(\log n)$. Pro jejich popis je nutné definovat \emph{interní uzly} - všechny uzly stromu a \emph{externí uzly} - na (interních) listech (a uzlech s jedním potomkem) umìle pøidané NULLové ukazatele (de facto \uv{listy} èerveno-èerného stromu). Externí uzly slouí jenom jako abstrakce pro popis stromù, pøi implementaci se s nimi neoperuje. 

Pøi operacích (insert, delete) nedìláme nikdy víc ne 2 rotace, a pouívají se èasto pøi implementaci asociativního pole.

Èerveno-èernı strom má tyto ètyøi povinné vlastnosti:
\begin{penumerate}
    \item Kadı uzel (externí i interní) má definovanou barvu, a to èernou nebo èervenou.
    \item Kadı externí uzel a koøen je èernı.
    \item Kadı èervenı vrchol musí mít oba syny èerné a otce taky.
    \item Kadá cesta od libovolného vrcholu k listùm v jeho podstromì musí obsahovat stejnı poèet èernıch uzlù.
\end{penumerate}

Pro èerveno-èerné stromy se definuje \emph{vıška uzlu} $x$ ($\b{h}(x)$) jako poèet uzlù na nejdelší moné cestì k listu v jeho podstromì. \emph{Èerná vıška uzlu} ($\b{bh}(x)$) je poèet èernıch uzlù na takové cestì.
\end{e}

\begin{e}{Vìta}{0}{Vlastnosti èerveno-èernıch stromù}
Podstrom libovolného uzlu $x$ obsahuje alespoò $2^{\b{bh}(x)}-1$ interních uzlù. Díky tomu má èerveno-èernı strom vıšku vdy nejvıše $2\log(n+1)$ (kde $n$ je poèet uzlù). (Dùkaz prvního tvrzení indukcí podle $\b{h}(x)$, druhého z prvního a tøetí vlastnosti èerveno-èernıch stromù)
    \end{e}

\begin{e}{Dùsledek}{0}{0}
Operace hledání (minima, maxima, následníka, \dots), které jsou stejné jako u obecnıch binárních vyhledávacích stromù, mají garantovanou èasovou sloitost $O(\log n)$.
\end{e}

\begin{e}{Algoritmus}{0}{Vkládání a odebírání uzlù v èerveno èernıch stromech}
Obì operace mají podle garantované max. vıšky garantovanou èas. sloitost $O(\log n)$ pro $n$ poèet uzlù. Protoe bez porušení vlastností èerveno-èernıch stromù lze koøen vdy pøebarvit naèerno, mùeme pro nì pøedpokládat, e \emph{koøen stromu} je \emph{vdy èernı}.

\emph{Vkládání} vypadá následovnì:
\begin{pitemize}
    \item Nalezení místa pro vloení a pøidání nového prvku jako v obecnıch bin. vyhl. stromech, novı prvek se pøebarví naèerveno.
    \item Pokud je jeho otec èernı, mùeme skonèit -- vlastnosti stromù jsou splnìné. Pokud je èervenı, musíme strom upravovat (tady pøedpokládám, e otec pøidávaného uzlu je levım synem, opaènı pøipad je symetrickı):
    \item Je-li i strıc èervenı, pøebarvit otce a strıce naèerno a pøenést chybu o patro vıš (je-li dìd èernı, konèím, jinak mùu pokraèovat a do koøene, kterı u lze pøebarvovat beztrestnì).
    \item Je-li strıc èernı a pøidanı uzel je levım synem, udìlat pravou rotaci na dìdovi a pøebarvit uzly tak, aby odpovídaly vlastnostem stromù.
    \item Je-li strıc èernı a pøidanı uzel je pravım synem, udìlat levou rotaci na otci a pøevést tak na pøedchozí pøípad.
\end{pitemize}

\emph{Odebírání} se provádí takto:
\begin{pitemize}
    \item Odstraním uzel stejnì jako v pøedchozím pøípadì. Opravdu odstranìnı uzel (z pøepojování) má max. jednoho syna. Pokud odstraòovanı uzel byl èervenı, neporuším vlastnosti stromù, stejnì tak pokud jeho syn byl èervenı -- to øeším jeho pøebarvením naèerno.
    \item V opaèném pøípadì (tj. syn odebíraného -- $x$ -- je èernı) musím udìlat násl. úpravy (pøep. e $x$ je levım synem svého nového otce, v op. pøípadì postupuji symetricky):
    \item $x$ prohlásím za \uv{dvojitì èernı} a této vlastnosti se pokouším zbavit.
    \item Pokud je bratr $x$ (buï $w$) èervenı, pak má 2 èerné syny -- provedu levou rotaci na rodièi $x$, prohodím barvy rodièe $x$ a uzlu $w$ a pøevedu tak situaci na jeden z násl. pøípadù:
    \item Je-li $w$ èernı a má-li 2 èerné syny, prohlásím $x$ za èernı a pøebarvím $w$ naèerveno, rodièe pøebarvím buï na èerno (a konèím) nebo na \uv{dvojitì èernou} a propaguji chybu (mohu dojít a do koøene, kterı lze pøebarovat beztrestnì).
    \item Je-li $w$ èernı, jeho levı syn èervenı a pravı èernı, vymìním barvy $w$ s jeho levım synem a na $w$ pouiji pravou rotaci, èím dostanu poslední pøípad:
    \item Je-li $w$ èernı a jeho pravı syn èervenı, pøebarvím pravého syna naèerno, odstraním dvojitì èernou z $x$, provedu levou rotaci na $w$ a pokud mìl pùvodnì $w$ (a $x$) èerveného otce, pøebarvím $w$ naèerveno a tohoto (teï u levého syna $w$) pøebarvím naèerno.
\end{pitemize}
\end{e}


\begin{e}{Definice}{0}{AVL stromy (Adelson-Velsky \& Landis)}
\emph{AVL stromy} jsou, podobnì jako èerveno-èerné stromy, bin. vyhledávací stromy, které zaruèují max. logaritmickı nárùst vıšky vzhledem k poètu prvkù. Pro kadı uzel $x$ se v AVL stromu definuje \emph{faktor vyváení} jako rozdíl vıšky jeho levého a pravého podstromu: $\b{bf}(x) = h(\texttt{x->levı}) - h(\texttt{x->pravı})$. Pro všechny uzly v AVL stromu platí, e $|\b{bf}(x)|\leq 1$.
\end{e}

\begin{e}{Vìta}{0}{Zaruèení vıšky AVL stromù}
Vıška AVL stromu s $n$ vrcholy je $O(\log n)$. (Dùkaz: buï $T_n$ AVL strom vıšky $n$ s minimálním poètem uzlù. Ten má podstromy $T_{n-1}$ a $T_{n-2}$ atd., tj. velikost minimálního AVL stromu roste jako Fibonacciho posloupnost, tedy $|T_n|\geq (\frac{1+\sqrt{5}}{2})^{n-1}$. Dùkaz tohoto indukcí.)
\end{e}

\begin{e}{Algoritmus}{0}{Operace na AVL stromech}
Vyhledávací operace se provádí stejnì jako na obecnıch bin. vyhledávacích stromech, vkládání a odebírání prvkù taky, ale pokud tyto operace poruší zákl. vlastnost AVL stromù ($|\b{bf}(x)=2|$), je nutné provést vyvaování -- pomocí rotací (které mohou bıt propagovány a ke koøeni). Pøi vkládání a odebírání je navíc nutné prùbìnì (nejhùøe a ke koøeni) upravovat indikaci faktoru vyváení jednotlivıch uzlù.
\end{e}

TODO: Splay stromy + Optimálni BVS!

\subsubsection*{Halda}

\begin{e}{Definice}{0}{0}
\emph{Halda(heap)} je dynamická mnoina se stromovou strukturou (binární halda je binární strom), pro kterou platí tzv. \uv{vlastnost haldy}: $$\text{ Je-li }x\text{ potomek }y\text{, pak }x\texttt{->klíè}\geq y\texttt{->klíè}$$ Haldy s touto nerovností jsou tzv. \emph{min-heap}y, pokud je nerovnost opaèná, jde o \emph{max-heap}.
\end{e}

\begin{obecne}{(Binární) haldy}
Binární haldy jsou nejèastìjším typem haldy. Zajišují nalezení minimálního prvku v konstantním èase a odebrání a pøidání minima v èase $O(\log n)$. V kadé hladinì od první a do pøedposlední je max. monı poèet uzlù, v poslední jsou uzly co nejvíce \uv{vlevo} -- tedy max. vıška haldy s $n$ prvky je $(\log n) + 1$. Proto je pro binární haldy jednoduše proveditelná jejich datová reprezentace polem (bez pointerù), kde pøi indexování od 0 má uzel na indexu $k$:
\begin{pitemize}
    \item Levého a pravého syna na indexu $2k+1$, resp. $2k+2$ (pokud to není víc ne celk. poèet prvkù, potom syny nemá).
    \item Rodièe na indexu $\lceil\frac{k}{2}\rceil-1$. 
\end{pitemize}

\emph{Pøidání uzlu} do haldy znamená pøidání prvku na konec haldy a dokud má jeho rodiè vìtší klíè, jeho prohazování s rodièem (tedy posouvání o vrstvu vıš). Pøi \emph{odebírání uzlu} z haldy tento nahradím posledním prvkem v haldì a potom dokud neplatí vlastnost haldy (nejménì jeden z potomkù má menší klíè), prohazuji ho s potomkem s menším klíèem (a posouvám o vrstvu ní).

Vytvoøení haldy je moné v èase $O(n)$, kde $n$ je poèet prvkù v haldì -- pøidání 1 prvku do haldy trvá $O(h)$, kde $h$ je aktuální vıška (a $h$ roste od $0$ a k $\lceil\log n\rceil$, poèet prvkù ve vıšce $k$ je $\frac{n}{2^{k+1}}$, bereme-li vıšku listù rovnou nule) - v souètu za všechny prvky jde o $O(n\cdot\sum_{h=0}^{\lceil\log n\rceil}\frac{h}{2^h})$.

Binární halda se pouívá napø. k \emph{tøídìní haldou} (heapsortu), kdy se z dat, která je potøeba utøídit, nejdøíve postaví halda, a potom se opakuje operace odebrání koøene (tj. minimálního prvku).
\end{obecne}

TODO: Binomiální haldy!

\begin{obecne}{Fibonacciho haldy}
Fibonacciho haldy mají nízkou èasovou sloitost bìnıch operací -- amortizovanì $O(1)$ pro vloení, hledání minima apod.; odebrání prvku a odebrání minima má sloitost $O(\log n)$ pro $n$ prvkù v haldì. Tvoøí ji skupina stromù, vyhovujících \uv{vlastnosti haldy}. Kadı uzel haldy s $n$ prvky má max. $\log n$ potomkù a ve svém podstromì minimálnì $F_{k+2}$ uzlù, kde $F_k$ je $k$-té Fibonacciho èíslo. To je zajištìno pravidlem, e pøi odebírání prvkù lze z nekoøenového uzlu oddìlit max. 1 syna, jinak je nutné oddìlit i tento uzel a ten se pak stane koøenem dalšího stromu. Poèet stromù se sniuje pøi odebírání minima, kdy jsou spojovány dohromady.

Fibonacciho haldy se pouívají pro efektivní implementaci sloitìjších operací, jako napø. Jarníkova nebo Dijkstrova algoritmu.
\end{obecne}

\begin{e}{Report}{emlièka}{0} Napsal jsem tam toho myslim dost, popis a slozitost operaci, prumerna vyska pr. stromu, u AVL rotace, kolik max rotaci pri jake operaci, max hloubku AVL stromu, i tu haldu, vcetne pekne reprezentace v poli (tam jsem nenapsal, ze syny najdu na pozici a2i a a2i+1, na coz se pak doplnkove ptal). Pro doplneni chtel CC stromy a splay-stromy (tam jsem zvoral, ze se vyhledavany zaznam "strci" do korene, pote, co zvedl oboci, jsem se rychle opravil "Ja jsem blbej, zarotuje az do korene"). Halda se mu nezdala, ac jsem tam napsal to vyuziti pri trideni na vnejsi pameti (predtrideni dvojitou haldou) - doufal jsem, ze ho to potesi, kdyz jsme to brali na OZD. ;) ... "Hmmm, a co jiny haldy?" Tak jsem priznal, ze nevim, ze jsem akorat slysel o Fibonaciho haldach. Chtel neco s vice-arnimi haldami a haldami, jejichz nazev jsem slysel snad poprve v zivote.
\end{e}
\begin{e}{Report}{emlièka}{0}
Zemla byl....no, jako na OZD, co k tomu rict;). Otazky vybiral podle xichtu a me osobne moc nerypal (ostatni ze skupiny toto zrejme ale nepotvrdi) - zakladem je ho zahltit papiry a prikyvovat;). Prekladace byly dost zamotane a navic byl dost nespokojen, ze znam jen klasicke haldy a zadne fibbonacciho,leftist,... Na konci me ohromil vetou "Tak to mate vymalovano". 
\end{e}
\begin{e}{Report}{Kopeckı}{0} BVS a vyvaování: (AVL + RedBlack). Dotaz na optimální vyhledávací stromy: popsal jsem splay (ani jsem tušil, e se tak jmenují), ale e na statické o.v.s. se hodí dynamické programování, jsem si "vzpomnil" a po nápovidi. 
\end{e}
\begin{e}{Report}{Kopeckı}{0} Tohle jsem mel vse, az na malou chybicku u AVL, ze pri pridani staci provest max. jednu rotaci a take jsem nevededel vyhledavaci stromy, kde krom klice je ulozena i potencionalni cetnost hledani.
\end{e}
\begin{e}{Report}{Skopal}{0} B-stromy a analogie s RB stromy - nechtil víc ne definici a odhady sloitosti FIND v nejhorším a nejlepším poípadi 
\end{e}
\begin{e}{Report}{Kopeckı}{0} BVS a vyvazovani - tady chtel Kopecky slyset rozdily mezi AVL a RB, algoritmus pro optimalni binarni vyhledavaci strom, splay stromy
\end{e}
\begin{e}{Report}{Obdrálek}{0}Tady to bylo celkem v pohode, az na to, ze se jim trochu nelibilo, ze jsem nedal dohromady definici optimalniho BVS, haldy jim stacily
pouze binarni, zadne Fibonacciho ani slyset nechteli
\end{e}