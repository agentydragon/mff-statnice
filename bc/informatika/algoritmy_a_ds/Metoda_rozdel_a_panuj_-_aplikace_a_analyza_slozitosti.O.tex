\subsection{Metoda rozdìl a panuj -- aplikace a analıza sloitosti}

\begin{definiceN}{Metoda rozdìl a panuj}
\emph{Rozdìl a panuj} je metoda návrhu algoritmù (ne strukturované programování), která má 3 kroky:
\begin{penumerate}
    \item \emph{rozdìl} -- rozdìlí úlohu na nìkolik podúloh stejného typu, ale menší velikosti
    \item \emph{vyøeš} -- vyøeší podúlohy buï pøímo pro dostateènì malé (èasto triviální), nebo rekurzivnì dìlíme dál pokud jsou ještì moc velké
    \item \emph{sjedno} -- sjednotí øešení podúloh do øešení pùvodní úlohy
\end{penumerate}
\end{definiceN}

\begin{poznamkaN}{Vytvoøení rekurentní rovnice}
Pro èasovou sloitost algoritmù typu rozdìl a panuj zpravidla dostávám nìjakou rekurentní rovnici.
\begin{pitemize}
    \item $T(n)$ budi doba zpracování úlohy velikosti $n$, za pøedpokladu, e $T(n)=\Theta(1)$ pro $n\leq n_0$.
    \item $D(n)$ budi doba na rozdìlení úlohy velikosti $n$ na $a$ podúloh stejné velikosti $\frac{n}{c}$. 
    \item $S(n)$ budi doba na sjednocení øešení podúloh velikosti $\frac{n}{c}$ na jednu úlohu velikosti $n$.
\end{pitemize}
Dostávám rovnici
$$T(n)=\begin{cases} D(n)+aT(\frac{n}{c})+S(n) \quad\quad & n > n_0 \\ \Theta(1) & n \leq n_0 \end{cases}$$
\end{poznamkaN}

\subsubsection*{Metody øešení rekurentních rovnic}

\begin{poznamkaN}{k øešení rekurentních rovnic}
\begin{pitemize}
    \item Pøedpoklad $T(n) = \Theta(1)$  pro dostateènì malá n nepíšeme explicitnì do rovnice
    \item Zanedbáváme celoèíselnost (tj. píšeme $\frac{n}{2}$ místo $\lceil\frac{n}{2}\rceil$ a $\lfloor\frac{n}{2}\rfloor$)
    \item Nehledíme na konkrétní hodnoty aditivních a multiplikativních konstant, asymptotické notace pouívám i v zadání rekurentních rovnic, i v jejich øešení.
\end{pitemize}
\end{poznamkaN}


\begin{vetaN}{Substituèní metoda}
\begin{penumerate}
    \item Uhodnu asymptoticky správné øešení
    \item Indukcí ovìøím správnost (zvláštì horní a dolní odhad)
\end{penumerate}
\end{vetaN}

\begin{vetaN}{Metoda \uv{kuchaøka} (Master Theorem)}
Nech $a\geq 1, c>1,d\geq 0\in\Real$ a nech $T:\Nat\to\Nat$ je neklesající funkce taková, e $\forall n$ tvaru $c^k$ platí
$$T(n)=aT(\frac{n}{c}) + \Theta(n^d)$$
Potom
\begin{penumerate}
    \item Je-li $a \neq c^d$, pak $T(n)$ je $\Theta( n^{\max\{\log_c a, d\}} )$
    \item Je-li $a = c^d$, pak $T(n)$ je $\Theta( n^d \log_c d )$
\end{penumerate}
\end{vetaN}

\begin{vetaN}{Master Theorem, varianta 2}
Nech $0<a_i<1$, kde $i\in\{1,\dots,k\}$  a $d\geq 0$ jsou reálná èísla a nech $T:\Nat\to\Nat$ splòuje rekurenci $$T(n)=\sum_{i=1}^k T(a_i\cdot n) + \Theta(n^d)$$ Nech je èíslo $x$ øešením rovnice $\sum_{i=1}^k a_i^x = 1$. Potom
\begin{penumerate}
    \item Je-li $x \neq d$ (tedy $\sum_{i=1}^k a_i^d \neq 1$), pak $T(n)$ je $\Theta( n^{\max\{x, d\}} )$
    \item Je-li $x = d$ (tedy $\sum_{i=1}^k a_i^d = 1$), pak $T(n)$ je $\Theta( n^d \log d )$
\end{penumerate}
\end{vetaN}

\subsubsection{Násobení matic n$\times$n a Strassenùv algoritmus}

Nejdøíve si pøipomeneme definici násobení dvou ètvercovıch matic typu $n \times n$. Platí, e prvek v $i$-tém øádku a $j$-tém sloupci vısledné matice $Z$ se rovná standardnímu skalárnímu souèinu $i$-tého øádku první matice $X$ a $j$-tého sloupce druhé matice~$Y$. Formálnì zapsáno:

$$ Z_{ij} = \sum_{k=1}^n X_{ik} \cdot Y_{kj}. $$

\begin{center}
\includegraphics{informatika/algoritmy_a_ds/obrazky/nasobeni-matic.eps}
\end{center}
Algoritmus, kterı by násobil matice podle této definice, by mìl èasovou sloitost $ \Theta(n^3) $, protoe poèet prvkù ve vısledné matici je $n^2$ a jeden skalární souèin vektorù dimenze $n$ vyaduje lineární poèet operací.

My se s touto èasovou sloitostí ovšem nespokojíme a budeme postupovat podobnì jako pøi vylepšování algoritmu na násobení velkıch èísel. Bez újmy na obecnosti pøedpokládejme, e budeme násobit dvì matice typu $n \times n$, kde $n=2^k, k \in \bb N$. Obì tyto matice rozdìlíme na ètvrtiny a tyto èásti postupnì oznaèíme u matice $X$ písmeny $A$, $B$, $C$ a $D$, u matice $Y$ písmeny $P$, $Q$, $R$ a $S$. Z definice násobení matic zjistíme, e ètvrtiny vısledné matice $Z$ mùeme zapsat pomocí souèinù èástí násobenıch matic. Levá horní ètvrtina bude odpovídat vısledku operací $AP+BR$, pravá horní ètvrtina bude $AQ+BS$, levá dolní $CP+DR$ a zbylá $CQ+DS$ (viz obrázek).

\begin{center}
\includegraphics{informatika/algoritmy_a_ds/obrazky/nasobeni-matic-2.eps}
\\{Násobení rozètvrcenıch matic}
\end{center}


Pøevedli jsme tedy problém násobení ètvercovıch matic øádu $n$ na násobení ètvercovıch matic øádu ${n/2}$. Tímto rozdìlováním bychom mohli pokraèovat, dokud bychom se nedostali na matice øádu 1, jejich vynásobení je triviální. Dostali jsme tedy klasickı algoritmus typu {\it rozdìl a panuj}. Pomohli jsme si ale nìjak? V kadém kroku provádíme 8 násobení matic polovièního øádu a navíc konstantní poèet operací na $n^2$ prvcích. Dostáváme tedy rekurentní zápis èasové sloitosti:

$$ T(n) = 8T\left({n \over 2}\right) + \Theta(n^2). $$

Pouitím Master Theoremu lehce dojdeme k závìru, e sloitost je stále $\Theta(n^3)$, tedy stejná jako pøi násobení matic z definice. Zdánlivì jsme si tedy nepomohli, ale stejnì jako tomu bylo u násobení velkıch èísel, i teï mùeme zredukovat poèet násobení matic polovièního øádu, které nejvíce ovlivòuje èasovou sloitost algoritmu. Není to bohuel nic triviálního, a proto si radìji rovnou øekneme správné øešení. Jedná se o Strassenùv algoritmus, kterı redukuje potøebnı poèet násobení na~7, a ještì pøed tím, ne si ukáeme, jak funguje, dokáeme si, jak nám to s èasovou sloitostí vlastnì pomùe:

$$ T(n) = 7T\left({n \over 2}\right) + \Theta(n^2) \Longrightarrow \Theta(n^{\log_2 7}) = \Theta(n^{2.808}). $$

Vısledná sloitost Strassenova algoritmu je tedy $\Theta(n^{2.808})$, co je sice malé, ale pro velké matice znatelné zlepšení oproti algoritmu vycházejícímu pøímo z~definice \footnote{
Zatím nejlepší dokázanı algoritmus má èasovou sloitost $\Theta(n^{2.376})$, $ $ ovšem s velkou multiplikativní konstantou.}.

\s{Lemma:} (vzorce pro násobení blokovıch matic ve~Strassenovì algoritmu)

\def\\{\noalign{\vskip 7pt}}

$$
\begin{pmatrix}A & B \\ C & D \end{pmatrix}
\cdot
\begin{pmatrix}P & Q \\ R & S \end{pmatrix}
=
\begin{pmatrix}
T_1 + T_4 - T_5 + T_7 &
T_3 + T_5 \\
T_2 + T_4 &
T_1 - T_2 + T_3 + T_6
\end{pmatrix}$$

kde:

$$\vbox{\halign{$#$\hfil\qquad &$#$\hfil\qquad \cr
T_1 = (A+D)\cdot(P+S)           & T_5 = (A+B)\cdot S \cr\\
T_2 = (C+D)\cdot P              & T_6 = (C-A)\cdot (P+Q) \cr\\
T_3 = A\cdot(Q-S)               & T_7 = (B-D)\cdot (R+S) \cr\\
T_4 = D\cdot(R-P)                                        \cr
}}$$

\medskip

\proof Do ètvercù $4 \times 4$ si napíšeme znaky $+$ nebo $-$ podle toho, jestli se pøi vıpoètu dané matice pøièítá nebo odeèítá pøíslušnı souèin dvou matic. Øádky znamenají matice $A$, $B$, $C$ a $D$ a sloupce znaèí matice $P$, $Q$, $R$ a $S$. Pokud se tedy v prvním øádku a prvním sloupci vyskytuje znak $+$, znamená to e pøièteme souèin matic $A$~a~$P$. Nejdøíve si spoèítáme pomocné matice $T_1$ a $T_7$ a z nich pak dopoèítáme, co bude na pøíslušnıch místech ve vısledné matici.

$$
T_1 = \begin{pmatrix}+&.&.&+\\.&.&.&.\\.&.&.&.\\+&.&.&+\end{pmatrix} \qquad
T_2 = \begin{pmatrix}.&.&.&.\\.&.&.&.\\+&.&.&.\\+&.&.&.\end{pmatrix} \qquad
T_3 = \begin{pmatrix}.&+&.&-\\.&.&.&.\\.&.&.&.\\.&.&.&.\end{pmatrix} \qquad
T_4 = \begin{pmatrix}.&.&.&.\\.&.&.&.\\.&.&.&.\\-&.&+&.\end{pmatrix}
$$
$$
T_5 = \begin{pmatrix}.&.&.&+\\.&.&.&+\\.&.&.&.\\.&.&.&.\end{pmatrix} \qquad
T_6 = \begin{pmatrix}-&-&.&.\\.&.&.&.\\+&+&.&.\\.&.&.&.\end{pmatrix} \qquad
T_7 = \begin{pmatrix}.&.&.&.\\.&.&+&+\\.&.&.&.\\.&.&-&-\end{pmatrix}\qquad
$$

\medskip

\def\\{\noalign{\vskip 7pt}}
$$
\eqalign{
T_1 + T_4 - T_5 + T_7 &= \begin{pmatrix}+&.&.&.\\.&.&+&.\\.&.&.&.\\.&.&.&.\end{pmatrix} = AP + BR \cr\\
T_3 + T_5 &= \begin{pmatrix}.&+&.&.\\.&.&.&+\\.&.&.&.\\.&.&.&.\end{pmatrix} = AQ + BS \cr\\
T_2 + T_4 &= \begin{pmatrix}.&.&.&.\\.&.&.&.\\+&.&.&.\\.&.&+&.\end{pmatrix} = CP + DR \cr\\
T_1 - T_2 + T_3 + T_6 &= \begin{pmatrix}.&.&.&.\\.&.&.&.\\.&+&.&.\\.&.&.&+\end{pmatrix} = CQ + DS \cr
}
$$
\\\\
% konec slidu z prednasky

Jak je vidìt, vısledná matice je tvoøena stejnımi èástmi jako pøi obyèejném násobení. 

\\\\
\subsubsection{Hledání mediánu v lin. èase (Blum et al.)}
\begin{algoritmusN}{Blum et al.}
\emph{Select(X,k)}
\begin{penumerate}
\item Pokud $n \leq 5 \Rightarrow$ vyøešíme pøímo
\item Vstup rozdìlíme na pìtice $P_1 . . . P_{\lceil n/5\rceil}$ (poslední mùe bıt neúplná), to zvládneme v $O(n)$
\item  $\forall i\in\{1...\lceil n/5\rceil\}:~~ m_i := median(Pi)$, to zvládneme v $O(n)$
\item $ pivot := Select (m_1,...,m_{\lceil n/5\rceil}, \lceil n/10\rceil)$     (medián mediánù)
\item Rozdìlime X na L(=menší ne pivot), S(=stejné jako pivot), P(=vìtší ne pivot)
\item Rekurzivnì se zavolame na jednu z L, S, P (tu, ve ktere se ma vyskytovat hledany prvek – zjistíme podle jejich velikosti)
\end{penumerate}
\end{algoritmus}
\begin{obecne}{Èasová sloitost:} V kadém kroku vypadne alespoò $\frac{3n}{10}$ prvkù.
\proof Pøedstavme si vybrané pìtice seøazené podle velikosti od nejvìtšího prvku a zakresleme je do sloupcù. Jejich mediány tedy vyplòují prostøední øadu. Tyto pìtice pak seøaïme podle velikosti jejich mediánù (nejmenší vlevo). Hledanı pivot se tedy nachází (pokud pøedpokládáme pro jednoduchost lichı poèet pìtic) pøesnì uprostøed. O prvcích nad pivotem a napravo od nìj mùeme urèitì øíct, e jsou vìtší nebo rovny pivotu, prvky pod ním a nalevo od nìj jsou zase urèitì menší nebo rovny pivotu. Podle algoritmu vdy vypadne jedna nebo druhá skupina prvkù o velikosti alespoò $\frac{3n}{10}$ prvkù (z obrázku).
\begin{center}
\includegraphics[scale=1.8]{informatika/algoritmy_a_ds/obrazky/petice.png}
\end{center}
V kadém kroku funkce volá sama sebe na vstup velikosti nejvıše n/5 a pak na 7n/10 ostatní operace jsou lineární, nejhorší pøípad: $T(n)=O(n)+T(\frac{n}{5})+T(\frac{7n}{10}) $, odhadneme e odpovídá lin.sloitosti O(n).
\proof
Indukcí e $T(n) = O(n):\exists k>0 \exists n_0 \forall n>n_0: T(n)\leq kn $ pro nìjakou dostateènì velkou konstantu k.
\begin{penumerate}
\item $n=1: T(n)= 1+k\frac{9}{10}\leq  k1$
\item $T(n)=O(n)+T(\frac{n}{5})+T(\frac{7n}{10})\leq n + k\frac{n}{5} + k\frac{7n}{10} = n + k\frac{9n}{10}$
\\
$n + k\frac{9n}{10} \leq kn \Rightarrow n \leq \frac{1}{10}kn \Rightarrow 10 \leq k$
\end{penumerate}


\subsubsection{MergeSort}

Tento tøídící algoritmus pracuje na~principu, e vstup rozdìlíme na~dvì (skoro) stejnì velké èásti, které rekurzivním voláním setøídíme, a~nakonec vısledné dvì posloupnosti slijeme do~jedné. 

\begin{algoritmusN}{MergeSort}

\begin{penumerate}
\item Vstup: posloupnost $x_1,\dots, x_n$.
\item Pokud $n \leq 1 \Rightarrow$ vrátíme vstup.
\item $y_1,\dots,y_{\lfloor n/2 \rfloor} \leftarrow$ \emph{MergeSort} $(x_1,\dots,x_{\lfloor n/2 \rfloor})$.
\item $z_1,\dots,z_{\lceil n/2 \rceil} \leftarrow$ \emph{MergeSort} $(x_{\lfloor n/2 \rfloor + 1},\dots,x_n)$.
\item Vrátíme \emph{MergeSort} $(y_1,\dots,y_{\lfloor n/2 \rfloor}; z_1,\dots,z_{\lceil n/2 \rceil})$.
\end{penumerate}

\noindent
Na slití dvou setøídìnıch posloupností do~jedné pouíváme funkci Merge:
\\\noindent
\emph{Merge} $(y_1, \dots,y_a;z_1, \dots,z_b)$

\begin{penumerate}
\item $i \leftarrow 1, j \leftarrow 1, k \leftarrow 1$.
\item Dokud $k \leq a+b$:
\item ~~~~~~~~Je-li $(j>b)$ nebo $(i \leq a) \& (y_i < z_j) \Rightarrow x_k \leftarrow y_i, k++, i++$.
\item ~~~~~~~~Jinak $\Rightarrow x_k \leftarrow z_j, k++, j++$.
\item Vrátíme $x_1, \dots,x_n$.
\end{penumerate}

\s{Pozorování:}
\emph{Merge} trvá $\Theta (n)$, nebo kadou ze~slévanıch posloupností projdeme právì jednou.

\medskip

\begin{obecne}{Èasová sloitost:}

Rozdìlování a~slévání nám trvá lineárnì dlouho, take pro èasovou sloitost MergeSortu platí tato rekurentní rovnice, kterou vyresime pomocí MT: $$T(n)= 2 \cdot T(n/2) + \Theta(n)  \Longrightarrow \Theta(n^1\log n}) = \Theta(n\log n).$$ 
\end{obecne}

\begin{obecne}{Pamìová sloitost:}

$$M(n) = d \cdot n + M(n/2) = d \cdot n + d \cdot n/2 + d \cdot n/4 + \dots \leq 2d n = \Theta(n).$$

Tento vztah platí pro nìjakou vhodnou konstantu $d$. Mùeme ho opìt nahlédnout napøíklad ze stromu rekurzivních volání. Podívejme se na~libovolnou cestu od~koøene do~listu. V~jednotlivıch vrcholech potøebujeme pamìti pøesnì $d \cdot n/2^k$, kde $k$ je èíslo hladiny. Kdy tyto hodnoty seèteme pøes všechny vrcholy na~této cestì, vısledek bude konvergovat k~$2dn$, co dává pamìovou sloitost $\Theta(n)$.
\end{obecne}
\begin{obecne}{Závìr:}
Mergesort bìí V~èase $\Theta(n \log{n})$ a~pamìti $\Theta(n)$. Lineární pamìová sloitost není vıhodná, ale na~druhou stranu se tento algoritmus velmi hodí napøíklad na~tøídìní lineárních spojovıch seznamù.
